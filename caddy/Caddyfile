rumoclaro.pt {
    # Block 1: Handle all API requests FIRST.
    # Once a request matches this, Caddy stops looking for other handlers.
    handle /api/* {
        reverse_proxy backend:8080
    }

    # Block 2: Handle EVERYTHING ELSE.
    # This block will only be reached if the request did NOT start with /api/.
    # This is where we serve the React frontend.
    handle {
        root * /usr/share/caddy
        try_files {path} /index.html
        file_server
    }
}